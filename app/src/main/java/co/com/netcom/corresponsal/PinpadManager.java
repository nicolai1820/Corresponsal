package co.com.netcom.corresponsal;

import android.content.Context;
import android.util.Log;

import com.ingenico.lar.bc.Pinpad;
import com.ingenico.lar.bc.PinpadCallbacks;
import com.ingenico.lar.bc.PinpadOutput;
import com.ingenico.lar.bc.PinpadOutputHandler;

import java.util.HashMap;

/**
 * A singleton interface to BC's Pinpad API to ease state sharing between the Activities of the
 * project.
 * <p>
 * Also allows to dynamically change the callbacks that will be used by Pinpad.
 */
public class PinpadManager implements PinpadCallbacks {

    final static String TAG = "PinpadManager";

    // the singleton instance
    static private PinpadManager myself = null;

    /**
     * Initialize this {@code PinpadManager} instance.
     * @param context The <i>application context</i> that the {@code Pinpad} will be bound to.
     * @return The singleton instance (the same as will be returned by {@link #me()}.
     * @throws UnsupportedOperationException in any error creating the {@code Pinpad} instance.
     */
    public static PinpadManager init(Context context) {
        Log.d(TAG, "PinpadManager.init(" + context + ")");
        if (myself == null) myself = new PinpadManager(context);
        return myself;
    }

    /**
     * Return the <i>already initialized</i> {@code PinpadManager} instance, or {@code null} if none.
     * @return The {@code PinpadManager} instance of {@code null} if {@link #init(Context)} has not
     *  been called yet.
     */
    public static PinpadManager me() {
        return myself;
    }

    /**
     * Return the message that shall be used for an {@code onShowMessage} with {@code id} and extra parameter {@code s}.
     * @return The message to show or {@code null} if no message shall be shown!
     */
    public static String formatMessage(int id, final String s) {
        switch (id) {
        case PinpadCallbacks.TEXT_S:
            return s;
        case PinpadCallbacks.PROCESSING:
            return "Procesando...";
        case PinpadCallbacks.INSERT_SWIPE_CARD:
            return "Insertar o deslizar la tarjeta";
        case PinpadCallbacks.TAP_INSERT_SWIPE_CARD:
            return "Acercar, Insertar o deslizar la tarjeta";
        case PinpadCallbacks.SELECT:
            return "Select";
        case PinpadCallbacks.SELECTED_S:
      //      return "Selecciono: " + s;
        case PinpadCallbacks.INVALID_APP:
      //      return "Invalid Application";
        case PinpadCallbacks.WRONG_PIN_S:
            return "Insertar el PIN";
        case PinpadCallbacks.PIN_LAST_TRY:
            return "PIN Last Try!";
        case PinpadCallbacks.PIN_BLOCKED:
            return "PIN Blocked!";
        case PinpadCallbacks.CARD_BLOCKED:
            return "Card Blocked!";
        case PinpadCallbacks.REMOVE_CARD:
            return "Por favor, retire la tarjeta";
        case PinpadCallbacks.UPDATING_TABLES:
     //       return "Updating Tables...";
        case PinpadCallbacks.SECOND_TAP:
            return "Por favor ingrese nuevamente la tarjeta";
        case PinpadCallbacks.PIN_VERIFIED:
        case PinpadCallbacks.UPDATING_RECORD:
        case PinpadCallbacks.PIN_STARTING:
        default:
                return null;
        }
    }

    public final static String TIMESTAMP = "0000000002";

    private Pinpad pinpad;
    private PinpadCallbacks callbacks;

    private PinpadManager(Context context) {
        Log.d(TAG, "building Pinpad with " + context);
        HashMap<String, Object> params = new HashMap<>();
        params.put(Pinpad.PARAM_CONTEXT, context);
        this.pinpad = Pinpad.build(params, this);
        if (this.pinpad == null) {
            Log.e(TAG, "error building Pinpad");
            throw new UnsupportedOperationException("Pinpad construction error");
        }
    }

    /**
     * Change the callbacks that will be called by {@code Pinpad}.
     * @param callbacks New {@code PinpadCallback} instance.
     */
    public void setCallbacks(PinpadCallbacks callbacks) {
        assert callbacks != null;
        this.callbacks = callbacks;
    }

    /**
     * Update the BC tables given whatever the application must be using.
     */
    public void updateTables(PinpadCallbacks callbacks) {
        // TODO: this integrate with the configuration settings of the application, and may
        //      read from SQLite or some other source -- here we use hardcoded values.

        final String[] tables = {
                "013141040107A000000154444200000000000000000002BANRISUL DEBITO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040107A000000154444200000000000000000002BANRISUL DEBITO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040107A000000154444200000000000000000002BANRISUL DEBITO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040107A000000154444200000000000000000002BANRISUL DEBITO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040107A000000154444200000000000000000002BANRISUL DEBITO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040107A000000154444200000000000000000002BANRISUL DEBITO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040107A000000154444200000000000000000002BANRISUL DEBITO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040207A000000154435200000000000000000001BANRISUL CREDITO030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040207A000000154435200000000000000000001BANRISUL CREDITO030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040207A000000154435200000000000000000001BANRISUL CREDITO030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040207A000000154435200000000000000000001BANRISUL CREDITO030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040207A000000154435200000000000000000001BANRISUL CREDITO030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040207A000000154435200000000000000000001BANRISUL CREDITO030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040207A000000154435200000000000000000001BANRISUL CREDITO030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040307A000000004306000000000000000000002MAESTRO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040307A000000004306000000000000000000002MAESTRO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040307A000000004306000000000000000000002MAESTRO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040307A000000004306000000000000000000002MAESTRO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040307A000000004306000000000000000000002MAESTRO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040307A000000004306000000000000000000002MAESTRO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040307A000000004306000000000000000000002MAESTRO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040407A000000004101000000000000000000001MASTERCARD      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040407A000000004101000000000000000000001MASTERCARD      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040407A000000004101000000000000000000001MASTERCARD      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040407A000000004101000000000000000000001MASTERCARD      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040407A000000004101000000000000000000001MASTERCARD      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040407A000000004101000000000000000000001MASTERCARD      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040407A000000004101000000000000000000001MASTERCARD      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040507A000000003201000000000000000000002ELECTRON        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040507A000000003201000000000000000000002ELECTRON        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040507A000000003201000000000000000000002ELECTRON        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040507A000000003201000000000000000000002ELECTRON        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040507A000000003201000000000000000000002ELECTRON        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040507A000000003201000000000000000000002ELECTRON        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040507A000000003201000000000000000000002ELECTRON        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040607A000000003101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040607A000000003101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040607A000000003101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040607A000000003101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040607A000000003101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040607A000000003101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040607A000000003101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040807A000000664101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040807A000000664101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040807A000000664101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040807A000000664101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141040807A000000664101000000000000000000001CREDITO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041007A000000557603100000000000000000003VR REFEICAO     030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041007A000000557603100000000000000000003VR REFEICAO     030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041107A000000557602700000000000000000003VR ALIMENTACAO  030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041107A000000557602700000000000000000003VR ALIMENTACAO  030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041207A000000557602800000000000000000003VR AUTO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041207A000000557602800000000000000000003VR AUTO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041307A000000557603000000000000000000003VR CULTURA      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041307A000000557603000000000000000000003VR CULTURA      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041407A000000557603400000000000000000003VR BENEFICIOS   030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041407A000000557603400000000000000000003VR BENEFICIOS   030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041507A000000494201000000000000000000002DEBITO ELO      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141041507A000000494201000000000000000000002DEBITO ELO      03008400830000076986202000008075000154414100000260F8887000F0F00122D84000A8000810000000D84004F80000000000P19000F424000001388000013880001000000000000000000000000000000000000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC408480000010000000FC60849000",
                "013141041607A000000494101000000000000000000001CREDITO ELO     03008400830000076986202000008075000154414100000260F8886000F0F00121FC408480000010000000FC6084900000000000P19000F424000001388000013880001000000000000000000000000000000000000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC408480000010000000FC60849000",
                "013141041607A000000494101000000000000000000001CREDITO ELO     03008400830000076986202000008075000154414100000260F8886000F0F00122FC408480000010000000FC6084900000000000P19000F424000001388000013880001000000000000000000000000000000000000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC408480000010000000FC60849000",
                "013141041709A000000003050760200000000000000002ELO DEBITO      030084008300000769862020000080750001544141000002E0F0C87000F0F00121D84000A8000810000000D84004F800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000Y1  Y3Z3000000000000000000000000000000",
                "013141041709A000000003050760200000000000000002ELO DEBITO      030084008300000769862020000080750001544141000002E0F0C87000F0F00122D84000A8000810000000D84004F800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000Y1  Y3Z3000000000000000000000000000000",
                "013141041809A000000003050760100000000000000001ELO CREDITO     030084008300000769862020000080750001544141000002E0F0C86000F0F00121D84000A8000810000000D84004F800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000Y1  Y3Z3000000000000000000000000000000",
                "013141041809A000000003050760100000000000000001ELO CREDITO     030084008300000769862020000080750001544141000002E0F0C86000F0F00122D84000A8000810000000D84004F800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000Y1  Y3Z3000000000000000000000000000000",
                "013141043007A000000154435600000000000000000002BANRISUL NFC CV 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141043007A000000154435600000000000000000002BANRISUL NFC CV 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141043007A000000154435600000000000000000002BANRISUL NFC CV 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141043007A000000154435600000000000000000002BANRISUL NFC CV 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141043107A000000154544B00000000000000000001BANRISUL NFC TK 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141043107A000000154544B00000000000000000001BANRISUL NFC TK 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141043107A000000154544B00000000000000000001BANRISUL NFC TK 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141043107A000000154544B00000000000000000001BANRISUL NFC TK 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042007A000000442101000000000000000000001CABAL CREDITO   030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042007A000000442101000000000000000000001CABAL CREDITO   030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042107A000000442201000000000000000000002CABAL DEBITO    030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042107A000000442201000000000000000000002CABAL DEBITO    030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042207A000000442301000000000000000000002ALIMENTACAO     030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042207A000000442301000000000000000000002ALIMENTACAO     030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042307A000000442301100000000000000000002CABAL REFEICAO  030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042307A000000442301100000000000000000002CABAL REFEICAO  030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042407A000000442301200000000000000000002CULTURA         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042407A000000442301200000000000000000002CULTURA         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042507A000000442401000000000000000000002PEDAGIO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141042507A000000442401000000000000000000002PEDAGIO         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141044007A000000537201000000000000000000002SODEXO ALIMENT  030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141044007A000000537201000000000000000000002SODEXO ALIMENT  030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141044107A000000537202000000000000000000002SODEXO REFEICAO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141044107A000000537202000000000000000000002SODEXO REFEICAO 030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045107A000000494505000000000000000000002BENEFICIOS      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045107A000000494505000000000000000000002BENEFICIOS      030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045207A000000494501000000000000000000002REFEICAO        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045207A000000494501000000000000000000002REFEICAO        030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045307A000000494502000000000000000000002ALIMENTACAO     030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045307A000000494502000000000000000000002ALIMENTACAO     030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045407A000000065101000000000000000000002JSPEEDY         030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045508A000000333010101000000000000000002QUICKPASS 01    030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045608A000000333010102000000000000000002QUICKPASS 02    030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "013141045708A000000333010103000000000000000002QUICKPASS 03    030002000200021701702               00000000000060F0C8F000F0A00122FC50ACA0000000000000FC50ACF80000000000P04000F42400000000000001387000109F02065F2A029A039C0195059F370400000000009F37040000000000000000000000000000000000Y1Z1Y3Z3FC501C88000000800000FC501C8800",
                "0161120401A00000015401003010001248BCC0C02F309EF3123B2F44FCF6230E472AA9C12468EC96D244C4B72DDE7DD33BC494D3618D51420E9DE719CBB27B83A3A7D8D544899B02679FBB9DAD945A49E9CE3CDFD053F364110A1AC01AED6CD0C0C128BB02D35FDE51C566371D0FF1AB04D570F6F9EBD70B12B3B0BE06DE0A9CFE3A38CC0D70420D3B6400E8A6F1F3C0BFD24CB083EC89B42616A841334BA3D440F38166D642E40398321593B568BE0F2C0AC705897F77D80FF4294A5C4C244026E8ECC3F70B77DFED1A8B362432E37257099BECE324D40FF694B433D8F8A7A403D0A8FBCE28915D7CDE49A30E074D9BCA1D020390E5653EDEC104BD7B82847BD5212864E8D89E1F3B00000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120402A000000004FA001030000144A90FCD55AA2D5D9963E35ED0F440177699832F49C6BAB15CDAE5794BE93F934D4462D5D12762E48C38BA83D8445DEAA74195A301A102B2F114EADA0D180EE5E7A5C73E0C4E11F67A43DDAB5D55683B1474CC0627F44B8D3088A492FFAADAD4F42422D0E7013536C3C49AD3D0FAE96459B0F6B1B6056538A3D6D44640F94467B108867DEC40FAAECD740C00E2B7A8852D000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000015BED4068D96EA16D2D77E03D6036FC7A160EA99C000000000000000000000000000000000000000000",
                "0161120403A000000004F1001030000176A0DCF4BDE19C3546B4B6F0414D174DDE294AABBB828C5A834D73AAE27C99B0B053A90278007239B6459FF0BBCD7B4B9C6C50AC02CE91368DA1BD21AAEADBC65347337D89B68F5C99A09D05BE02DD1F8C5BA20E2F13FB2A27C41D3F85CAD5CF6668E75851EC66EDBF98851FD4E42C44C1D59F5984703B27D5B9F21B8FA0D93279FBBF69E090642909C9EA27F898959541AA6757F5F624104F6E1D3A9532F2A6E51515AEAD1B43B3D7835088A2FAFA7BE70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001D8E68DA167AB5A85D8C3D55ECB9B0517A1A5B4BB000000000000000000000000000000000000000000",
                "0161120404A000000004EF001030000248A191CB87473F29349B5D60A88B3EAEE0973AA6F1A082F358D849FDDFF9C091F899EDA9792CAF09EF28F5D22404B88A2293EEBBC1949C43BEA4D60CFD879A1539544E09E0F09F60F065B2BF2A13ECC705F3D468B9D33AE77AD9D3F19CA40F23DCF5EB7C04DC8F69EBA565B1EBCB4686CD274785530FF6F6E9EE43AA43FDB02CE00DAEC15C7B8FD6A9B394BABA419D3F6DC85E16569BE8E76989688EFEA2DF22FF7D35C043338DEAA982A02B866DE5328519EBBCD6F03CDD686673847F84DB651AB86C28CF1462562C577B853564A290C8556D818531268D25CC98A4CC6A0BDFFFDA2DCCA3A94C998559E307FDDF915006D9A987B07DDAEB3B121766EBB0EE122AFB65D7845B73DB46BAB65427A000000000000000000000000000000000000000000",
                "0161120405A000000004F300103000014498F0C770F23864C2E766DF02D1E833DFF4FFE92D696E1642F0A88C5694C6479D16DB1537BFE29E4FDC6E6E8AFD1B0EB7EA0124723C333179BF19E93F10658B2F776E829E87DAEDA9C94A8B3382199A350C077977C97AFF08FD11310AC950A72C3CA5002EF513FCCC286E646E3C5387535D509514B3B326E1234F9CB48C36DDD44B416D23654034A66F403BA511C5EFA300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001A69AC7603DAF566E972DEDC2CB433E07E8B01A9A000000000000000000000000000000000000000000",
                "0161120406A000000004F8001030000128A1F5E1C9BD8650BD43AB6EE56B891EF7459C0A24FA84F9127D1A6C79D4930F6DB1852E2510F18B61CD354DB83A356BD190B88AB8DF04284D02A4204A7B6CB7C5551977A9B36379CA3DE1A08E69F301C95CC1C20506959275F41723DD5D2925290579E5A95B0DF6323FC8E9273D6F849198C4996209166D9BFC973C361CC826E10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001F06ECC6D2AAEBF259B7E755A38D9A9B24E2FF3DD000000000000000000000000000000000000000000",
                "0161120407A000000004FE001030000128A653EAC1C0F786C8724F737F172997D63D1C3251C44402049B865BAE877D0F398CBFBE8A6035E24AFA086BEFDE9351E54B95708EE672F0968BCD50DCE40F783322B2ABA04EF137EF18ABF03C7DBC5813AEAEF3AA7797BA15DF7D5BA1CBAF7FD520B5A482D8D3FEE105077871113E23A49AF3926554A70FE10ED728CF793B62A100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000019A295B05FB390EF7923F57618A9FDA2941FC34E0000000000000000000000000000000000000000000",
                "0161120408A00000000399001030000128AB79FCC9520896967E776E64444E5DCDD6E13611874F3985722520425295EEA4BD0C2781DE7F31CD3D041F565F747306EED62954B17EDABA3A6C5B85A1DE1BEB9A34141AF38FCF8279C9DEA0D5A6710D08DB4124F041945587E20359BAB47B7575AD94262D4B25F264AF33DEDCF28E09615E937DE32EDC03C54445FE7E38277700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000014ABFFD6B1C51212D05552E431C5B17007D2F5E6D000000000000000000000000000000000000000000",
                "0161120409A00000000395001030000144BE9E1FA5E9A803852999C4AB432DB28600DCD9DAB76DFAAA47355A0FE37B1508AC6BF38860D3C6C2E5B12A3CAAF2A7005A7241EBAA7771112C74CF9A0634652FBCA0E5980C54A64761EA101A114E0F0B5572ADD57D010B7C9C887E104CA4EE1272DA66D997B9A90B5A6D624AB6C57E73C8F919000EB5F684898EF8C3DBEFB330C62660BED88EA78E909AFF05F6DA627B00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001EE1511CEC71020A9B90443B37B1D5F6E703030F6000000000000000000000000000000000000000000",
                "0161120410A00000000392001030000176996AF56F569187D09293C14810450ED8EE3357397B18A2458EFAA92DA3B6DF6514EC060195318FD43BE9B8F0CC669E3F844057CBDDF8BDA191BB64473BC8DC9A730DB8F6B4EDE3924186FFD9B8C7735789C23A36BA0B8AF65372EB57EA5D89E7D14E9C7B6B557460F10885DA16AC923F15AF3758F0F03EBD3C5C2C949CBA306DB44E6A2C076C5F67E281D7EF56785DC4D75945E491F01918800A9E2DC66F60080566CE0DAF8D17EAD46AD8E30A247C9F0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001429C954A3859CEF91295F663C963E582ED6EB253000000000000000000000000000000000000000000",
                "0161120411A00000000394001030000248ACD2B12302EE644F3F835ABD1FC7A6F62CCE48FFEC622AA8EF062BEF6FB8BA8BC68BBF6AB5870EED579BC3973E121303D34841A796D6DCBC41DBF9E52C4609795C0CCF7EE86FA1D5CB041071ED2C51D2202F63F1156C58A92D38BC60BDF424E1776E2BC9648078A03B36FB554375FC53D57C73F5160EA59F3AFC5398EC7B67758D65C9BFF7828B6B82D4BE124A416AB7301914311EA462C19F771F31B3B57336000DFF732D3B83DE07052D730354D297BEC72871DCCF0E193F171ABA27EE464C6A97690943D59BDABB2A27EB71CEEBDAFA1176046478FD62FEC452D5CA393296530AA3F41927ADFE434A2DF2AE3054F8840657A26E0FC6171C4A3C43CCF87327D136B804160E47D43B60E6E0F000000000000000000000000000000000000000000",
                "0161120412A00000049401001030000144E32D3DB7BAFE4E5423880FB49AF6250250B91AB818139F26A67D11982440A28685256E31002EDE3A50EC9709EF20116ABA6B9E3E99F3F6CCDE397BDCE4A2AC18BCEA4EEF842BB600D12A4005F355DF03E550CFA79E4F6FDAD2DA758EF74CC69E6B60E0A2A836070532516AD23E96B93C1DAACA9DEADC81ABEB5FD6BA4480E628D059431BF15C4B28585733A82E1B45C1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120413A000000494E2001030000248B303169291494ED69263243D1A617A15F943413D2ECFF0A98292884D15826B494E7925A087BC1FE54FCA44DAACB0A91A8F384F1AA9189F5EC7B15211C66129E2640A75313D584C6A992E04521B70E25DB49E35E65959F136ACE71602C954EB83E4223BECCD5DFF089AF5A5B444BF914463EF855E6DD642EBC6CA6CE662AFCA3DFFA32A44AB0D0C8CE1DBCEFFCA56CEBE31BDDCCB9DBD1C3BD00C099BBFBEEADC2672B809AFFDF2D1571AA4CC8AF96D41B0CF72369CEF6B15AED7930E21CC95AD32EEEB55210800942CDF82DB5B3B3B4896B15D1899114ED33DA43900B6DAF941BBD69431E83BE4D01E4FC36922C497E9F370309D51D6670700000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120414A000000494E1001030000176BEFA49A34C81522C4499745F2FFEDC5597A8049D8C75D80F3AE606DCEF62D2DD9AA97A031AFA0FDC80737C031D09729E25E9DF1A5C05E88040F7C4CEE2AFC0398A0BCF2BB491CD36F4F5C359B9BF7B12958C2E79E06BBB2F37BF748177E1AF6662F9EDEFED3A15A6E5E87A6258DE4F83B1AC75757526C9961C29DEB7E5C67B18A81FEB2F0E4E62DF86B75B2DE834EB4CA838EB486C18C161AED45159DCDEA9F0CF724F3DD6B7222A539F037E5291084500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120415A000000494E0001030000144D8D8A754F12A90EB3D1A6828F65300F1E938877732AC1CBB75E74EE9129398F62B8DE7812873442B5FA5CB27A42D17170E4F45B22AF25B03F36246ACD8C682292363C9C9FA470D4F60C2500E70732D19346E50097558E85428BF23C04D6907769E4B3236C84E4D43B3E07BD2CC8F8334022EDA760086BD4DD5088179A7EA3A42B4AC82C971287A0DD5E985DA6D8DF499000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120416A000000494EC001030000248CA6CB40C024295DE4F255BE98E7393B9C8F8F73E6BB1F6EC733BB1A0C384F86F47CCBF5F6201FBF999496DDA32A546F3BB5AAB851A05BDE4DB787E7A99902823FF53E31A38694FA13F0DF46623D2E1BEA06748AD2EA1C256527F1A131C3FF841543FC4485B259394B7A83C79C401A7626FC1587D8381D9A69A95A66C424BB76F11D0D11CEFBF5A2A350562BF65628C7E879B147C1919A84F0EC16BD71043CAFA7F66B5469C5B35387731D0CA767DA1B2D9796AE9BE651742D1F69B36AE47DC6E03FC52654C0C5CB240C56F18DE852C8609424A1AA3E1098634225468EF45F0F309D2A93561867D5AC9ECF85DF8B36AE9D0A0892823DD79F700000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120417A000000494EB001030000176BA2A73918CC729873DDE0F148AE5BD7355EE97C139A478D17A8D6983290FE90F1D34DBE4C9571E666F137AC0F373DAD0DE809908EA24846C06562AF92AB0D5CBA10090F1D557E850D99FA3C2BAB5CA83A15CB77E9E0F90F987E662DDA001BC134A353925DA26EADD7329487B0B9180F20720F07775E89A4A1E23E4EA9A47D336F020F522B7840B32705B0966BC925E99EA7B12A6BC5577864038273305AB6C5657D628EB754F19E9E15FB58497FFBF9100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120418A000000494EA001030000144AC156AEF59C83D7C108B39DB842DCFC9D66BE646C5F2BB3A977706998E59BDA43324B2DD1F551D975E9789D9D281123149E30321B2C49EDD76AA0D7FBFEDC1736E0E4D7D3B24DEFD3CA1CEC06DBEE9DD60F78C87A0E7D6BF92104B978BDA52A682536B739D63D721BCC3953A75A9E2103FEF0119710E0714DF4C7737018FB6AF683CBF03092F11E9FF6BE18F05207BBF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120419A000000442F1003010001176D9E36579B94A5FF3150B64643D85C06E6E9F0682BE56CDD69FCB053913495BDBC327DA3CAC0EA2A0DA1D55DF7C66A0C6F6A9039FA72753C434F4A63BED54062799DF1F6D6E1F315A8F4109721126E11F4FF562C18A4AE6A4D9F0C2A5C2A8E44D6A98628C7E25290584F0F3D9ECE6566FDB7688596649BEC89A1CBC8BBED075538300D0D83FF8755E1CE73668908C387E14ACDF0F9F1DE436A5A07308812D6AE3A16170EDF2522B36FBE94358F50C0B69000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000121FDF77F063EBBD416B6A4130D4A2C2D2BEA9C1C000000000000000000000000000000000000000000",
                "0161120420A000000442F2003010001248F1E227BE5F488FB217C01C9997E5E9976005206A6D7C0296166284D45C079FF3ED03BC2163F60E0D8815C028D52977835EC5A2B59E58552FFACFE582945D510F63D34D5272412C3254343B48D0965E735C8CE4F3114AA68F3B70C0B62A45B840246CA3271E2AFAE143C8174DDAF466F23A14C012F5FAE84CA3ED0CFF808FCD25939EF70AF0F59C837200F31093F7695478B4146BAF3129C0F6DF862F3D0B28813CD6328C0A1AA01F6E07A1B3368F1157C41DEA487DEC0E735491470BBD58D1168C04C7878F3DE755B32379823DBD55F200BD62DC8E7EFA0DA41CA574BD891B81E3ACF056A3843D69E83C72AE5C7D467596829591EFC85183129E7B4E1465153D4A51FE2CFBA32E230C0BC1B40000000000000000000000000000000000000000000",
                "0161120421A0000003330A001000003128B2AB1B6E9AC55A75ADFD5BBC34490E53C4C3381F34E60E7FAC21CC2B26DD34462B64A6FAE2495ED1DD383B8138BEA100FF9B7A111817E7B9869A9742B19E5C9DAC56F8B8827F11B05A08ECCF9E8D5E85B0F7CFA644EFF3E9B796688F38E006DEB21E101C01028903A06023AC5AAB8635F8E307A53AC742BDCE6A283F585F48EF00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120421A00000033308001000003144B61645EDFD5498FB246444037A0FA18C0F101EBD8EFA54573CE6E6A7FBF63ED21D66340852B0211CF5EEF6A1CD989F66AF21A8EB19DBD8DBC3706D135363A0D683D046304F5A836BC1BC632821AFE7A2F75DA3C50AC74C545A754562204137169663CFCC0B06E67E2109EBA41BC67FF20CC8AC80D7B6EE1A95465B3B2657533EA56D92D539E5064360EA4850FED2D1BF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120421A00000033309001000003176EB374DFC5A96B71D2863875EDA2EAFB96B1B439D3ECE0B1826A2672EEEFA7990286776F8BD989A15141A75C384DFC14FEF9243AAB32707659BE9E4797A247C2F0B6D99372F384AF62FE23BC54BCDC57A9ACD1D5585C303F201EF4E8B806AFB809DB1A3DB1CD112AC884F164A67B99C7D6E5A8A6DF1D3CAE6D7ED3D5BE725B2DE4ADE23FA679BF4EB15A93D8A6E29C7FFA1A70DE2E54F593D908A3BF9EBBD760BBFDC8DB8B54497E6C5BE0E4A4DAC29E500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120421A0000003330B001000003248CF9FDF46B356378E9AF311B0F981B21A1F22F250FB11F55C958709E3C7241918293483289EAE688A094C02C344E2999F315A72841F489E24B1BA0056CFAB3B479D0E826452375DCDBB67E97EC2AA66F4601D774FEAEF775ACCC621BFEB65FB0053FC5F392AA5E1D4C41A4DE9FFDFDF1327C4BB874F1F63A599EE3902FE95E729FD78D4234DC7E6CF1ABABAA3F6DB29B7F05D1D901D2E76A606A8CBFFFFECBD918FA2D278BDB43B0434F5D45134BE1C2781D157D501FF43E5F1C470967CD57CE53B64D82974C8275937C5D8502A1252A8A5D6088A259B694F98648D9AF2CB0EFD9D943C69F896D49FA39702162ACB5AF29B90BADE005BC15700000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120012A000000004FA0010300001609C6BE5ADB10B4BE3DCE2099B4B210672B89656EBA091204F613ECC623BEDC9C6D77B660E8BAEEA7F7CE30F1B153879A4E36459343D1FE47ACDBD41FCD710030C2BA1D9461597982C6E1BDD08554B726F5EFF7913CE59E79E357295C321E26D0B8BE270A9442345C753E2AA2ACFC9D30850602FE6CAC00C6DDF6B8D9D9B4879B2826B042A07F0E5AE526A3D3C4D22C72B9EAA52EED8893866F866387AC05A139900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120016A00000000401001030000248A6E6FB72179506F860CCCA8C27F99CECD94C7D4F3191D303BBEE37481C7AA15F233BA755E9E4376345A9A67E7994BDC1C680BB3522D8C93EB0CCC91AD31AD450DA30D337662D19AC03E2B4EF5F6EC18282D491E19767D7B24542DFDEFF6F62185503532069BBB369E3BB9FB19AC6F1C30B97D249EEE764E0BAC97F25C873D973953E5153A42064BBFABFD06A4BB486860BF6637406C9FC36813A4A75F75C31CCA9F69F8DE59ADECEF6BDE7E07800FCBE035D3176AF8473E23E9AA3DFEE221196D1148302677C720CFE2544A03DB553E7F1B8427BA1CC72B0F29B12DFEF4C081D076D353E71880AADFF386352AF0AB7B28ED49E1E672D11F9000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120017A0000000040000103000014498F0C770F23864C2E766DF02D1E833DFF4FFE92D696E1642F0A88C5694C6479D16DB1537BFE29E4FDC6E6E8AFD1B0EB7EA0124723C333179BF19E93F10658B2F776E829E87DAEDA9C94A8B3382199A350C077977C97AFF08FD11310AC950A72C3CA5002EF513FCCC286E646E3C5387535D509514B3B326E1234F9CB48C36DDD44B416D23654034A66F403BA511C5EFA30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120018A00000000402001030000224A25A6BD783A5EF6B8FB6F83055C260F5F99EA16678F3B9053E0F6498E82C3F5D1E8C38F13588017E2B12B3D8FF6F50167F46442910729E9E4D1B3739E5067C0AC7A1F4487E35F675BC16E233315165CB142BFDB25E301A632A54A3371EBAB6572DEEBAF370F337F057EE73B4AE46D1A8BC4DA853EC3CC12C8CBC2DA18322D68530C70B22BDAC351DD36068AE321E11ABF264F4D3569BB71214545005558DE26083C735DB776368172FE8C2F5C85E8B5B890CC682911D2DE71FA626B8817FCCC08922B703869F3BAEAC1459D77CD85376BC36182F4238314D6C4212FBDD7F23D3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120019A0000000040300103000012894EA62F6D58320E354C022ADDCF0559D8CF206CD92E869564905CE21D720F971B7AEA374830EBE1757115A85E088D41C6B77CF5EC821F30B1D890417BF2FA31E5908DED5FA677F8C7B184AD09028FDDE96B6A6109850AA800175EABCDBBB684A96C2EB6379DFEA08D32FE2331FE103233AD58DCDB1E6E077CB9F24EAEC5C25AF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120020A00000000404001030000128A1F5E1C9BD8650BD43AB6EE56B891EF7459C0A24FA84F9127D1A6C79D4930F6DB1852E2510F18B61CD354DB83A356BD190B88AB8DF04284D02A4204A7B6CB7C5551977A9B36379CA3DE1A08E69F301C95CC1C20506959275F41723DD5D2925290579E5A95B0DF6323FC8E9273D6F849198C4996209166D9BFC973C361CC826E1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120021A00000000405001030000174A99A6D3E071889ED9E3A0C391C69B0B804FC160B2B4BDD570C92DD5A0F45F53E8621F7C96C40224266735E1EE1B3C06238AE35046320FD8E81F8CEB3F8B4C97B940930A3AC5E790086DAD41A6A4F5117BA1CE2438A51AC053EB002AED866D2C458FD73359021A12029A0C043045C11664FE0219EC63C10BF2155BB2784609A106421D45163799738C1C30909BB6C6FE52BBB76397B9740CE064A613FF8411185F08842A423EAD20EDFFBFF1CD6C3FE0C9821479199C26D8572CC8AFFF087A9C30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120022A000000004F300103000014498F0C770F23864C2E766DF02D1E833DFF4FFE92D696E1642F0A88C5694C6479D16DB1537BFE29E4FDC6E6E8AFD1B0EB7EA0124723C333179BF19E93F10658B2F776E829E87DAEDA9C94A8B3382199A350C077977C97AFF08FD11310AC950A72C3CA5002EF513FCCC286E646E3C5387535D509514B3B326E1234F9CB48C36DDD44B416D23654034A66F403BA511C5EFA30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120023A000000004F5001030000288A6E6FB72179506F860CCCA8C27F99CECD94C7D4F3191D303BBEE37481C7AA15F233BA755E9E4376345A9A67E7994BDC1C680BB3522D8C93EB0CCC91AD31AD450DA30D337662D19AC03E2B4EF5F6EC18282D491E19767D7B24542DFDEFF6F62185503532069BBB369E3BB9FB19AC6F1C30B97D249EEE764E0BAC97F25C873D973953E5153A42064BBFABFD06A4BB486860BF6637406C9FC36813A4A75F75C31CCA9F69F8DE59ADECEF6BDE7E07800FCBE035D3176AF8473E23E9AA3DFEE221196D1148302677C720CFE2544A03DB553E7F1B8427BA1CC72B0F29B12DFEF4C081D076D353E71880AADFF386352AF0AB7B28ED49E1E672D11F9000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120024A000000004F6001030000144A25A6BD783A5EF6B8FB6F83055C260F5F99EA16678F3B9053E0F6498E82C3F5D1E8C38F13588017E2B12B3D8FF6F50167F46442910729E9E4D1B3739E5067C0AC7A1F4487E35F675BC16E233315165CB142BFDB25E301A632A54A3371EBAB6572DEEBAF370F337F057EE73B4AE46D1A8BC4DA853EC3CC12C8CBC2DA18322D68530C70B22BDAC351DD36068AE321E11ABF264F4D3569BB71214545005558DE26083C735DB776368172FE8C2F5C85E8B5B890CC682911D2DE71FA626B8817FCCC08922B703869F3BAEAC1459D77CD85376BC36182F4238314D6C4212FBDD7F23D3000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120025A000000004F700103000012894EA62F6D58320E354C022ADDCF0559D8CF206CD92E869564905CE21D720F971B7AEA374830EBE1757115A85E088D41C6B77CF5EC821F30B1D890417BF2FA31E5908DED5FA677F8C7B184AD09028FDDE96B6A6109850AA800175EABCDBBB684A96C2EB6379DFEA08D32FE2331FE103233AD58DCDB1E6E077CB9F24EAEC5C25AF000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120026A000000004F9001030000192A99A6D3E071889ED9E3A0C391C69B0B804FC160B2B4BDD570C92DD5A0F45F53E8621F7C96C40224266735E1EE1B3C06238AE35046320FD8E81F8CEB3F8B4C97B940930A3AC5E790086DAD41A6A4F5117BA1CE2438A51AC053EB002AED866D2C458FD73359021A12029A0C043045C11664FE0219EC63C10BF2155BB2784609A106421D45163799738C1C30909BB6C6FE52BBB76397B9740CE064A613FF8411185F08842A423EAD20EDFFBFF1CD6C3FE0C9821479199C26D8572CC8AFFF087A9C30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120027A0000000030300103000014498F0C770F23864C2E766DF02D1E833DFF4FFE92D696E1642F0A88C5694C6479D16DB1537BFE29E4FDC6E6E8AFD1B0EB7EA0124723C333179BF19E93F10658B2F776E829E87DAEDA9C94A8B3382199A350C077977C97AFF08FD11310AC950A72C3CA5002EF513FCCC286E646E3C5387535D509514B3B326E1234F9CB48C36DDD44B416D23654034A66F403BA511C5EFA30000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
                "0161120028A000000003F5001030000248A6E6FB72179506F860CCCA8C27F99CECD94C7D4F3191D303BBEE37481C7AA15F233BA755E9E4376345A9A67E7994BDC1C680BB3522D8C93EB0CCC91AD31AD450DA30D337662D19AC03E2B4EF5F6EC18282D491E19767D7B24542DFDEFF6F62185503532069BBB369E3BB9FB19AC6F1C30B97D249EEE764E0BAC97F25C873D973953E5153A42064BBFABFD06A4BB486860BF6637406C9FC36813A4A75F75C31CCA9F69F8DE59ADECEF6BDE7E07800FCBE035D3176AF8473E23E9AA3DFEE221196D1148302677C720CFE2544A03DB553E7F1B8427BA1CC72B0F29B12DFEF4C081D076D353E71880AADFF386352AF0AB7B28ED49E1E672D11F9000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
        };


        this.callbacks = callbacks;
        if (pinpad.tableLoadInit("00" + TIMESTAMP) == Pinpad.PP_TABEXP) {
            for (final String s : tables) pinpad.tableLoadRec(s);
            pinpad.tableLoadEnd();
        }
    }

    public void abort() {
        pinpad.abort();
    }

    public int open() {
        return pinpad.open();
    }

    public int getCard(final String input, final PinpadCallbacks callbacks, final PinpadOutputHandler handler) {
        this.callbacks = callbacks;
        return pinpad.getCard(input, handler);
    }

    public int resumeGetCard() {
        return pinpad.resumeGetCard();
    }

    public int goOnChip(final String input, final String tags, final PinpadCallbacks callbacks, final PinpadOutputHandler handler) {
        this.callbacks = callbacks;
        return pinpad.goOnChip(input, tags, null, handler);
    }

    public PinpadOutput finishChip(final String input, final String tags) {
        return pinpad.finishChip(input, tags);
    }

    public int removeCard(final String message, final PinpadCallbacks callbacks, final PinpadOutputHandler handler) {
        this.callbacks = callbacks;
        return pinpad.removeCard(message, handler );
    }

    public int checkEvent(final String input, final PinpadCallbacks callbacks, final PinpadOutputHandler handler) {
        this.callbacks = callbacks;
        return pinpad.checkEvent(input, handler);
    }

    public int getPin(final String input, final PinpadCallbacks callbacks, final PinpadOutputHandler handler) {
        this.callbacks = callbacks;
        return pinpad.getPIN(input,handler);
    }

    public static class TrackData {
        public String track1;
        public String track2;
        public String track3;

        public TrackData(String t1, String t2, String t3) {
            track1 = t1;
            track2 = t2;
            track3 = t3;
        }
    }

    public static TrackData extractTrack(final String output, int offset) {
        final int track1Len = Integer.parseInt(output.substring(offset, offset + 2));
        final String track1 = output.substring(offset + 2, offset + 2 + track1Len);
        Log.d(TAG, "track1 (" + track1Len + ") [" + track1 + "]");

        final int track2Len = Integer.parseInt(output.substring(offset + 78, offset + 80));
        final String track2 = output.substring(offset + 80, offset + 80 + track2Len);
        Log.d(TAG, "track2 (" + track2Len + ") [" + track2 + "]");

        final int track3Len = Integer.parseInt(output.substring(offset + 117, offset + 120));
        final String track3 = output.substring(offset + 120, offset + 120 + track3Len);
        Log.d(TAG, "track3 (" + track3Len + ") [" + track3 + "]");

        return new TrackData(track1, track2, track3);
    }

    @Override
    public int onShowMessage(int i, String s) {
        return (callbacks != null) ? callbacks.onShowMessage(i, s) : 0;
    }

    @Override
    public int onShowPinEntry(String s, long l, int i) {
        return (callbacks != null) ? callbacks.onShowPinEntry(s, l, i) : 0;
    }

    @Override
    public void onAbort() {
        if (callbacks != null) callbacks.onAbort();
    }

    @Override
    public void onShowMenu(int i, String s, String[] strings, MenuResult menuResult) {
        // if callbacks have not been set, arbitrarily select first menu entry
        if (callbacks != null) callbacks.onShowMenu(i, s, strings, menuResult);
        else menuResult.setResult(0, 0);
    }
}
